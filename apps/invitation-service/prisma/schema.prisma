generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
}

enum InvitationStatus {
  PENDING
  EXPIRED
  REJECTED
  ACCEPTED
}
enum InvitationTargetType {
  EVENT
}

model Invitation {
  id              String               @id @default(uuid())
  token           String               @unique@db.Text
  email           String               @db.VarChar(255)
  targetType      InvitationTargetType @map("target_type")
  targetId        Int               @map("target_id")
  status          InvitationStatus
  expiresAt       Int               @map("expires_at")
  invitedByUserId Int               @map("invited_by_user_id")
  invitedUserId         Int?         @map("invited_user_id")
  createdAt       DateTime             @map("created_at") @default(now()) @db.Timestamp()
  updatedAt       DateTime             @map("updated_at") @updatedAt @db.Timestamp()

  roles          InvitationRole[]        @relation("invitation_roles")
  @@map("invitations")
}

model InvitationRole {
  invitationId    String               @map("invitation_id")
  roleId          Int                  @map("role_id")

  invitation Invitation @relation("invitation_roles", fields: [invitationId], references: [id])

  @@id([invitationId, roleId])
}


